(function(){$(function(){FastClick.attach(document.body)});var h=angular.module("msmApp",["ngRoute","ngSanitize","angulartics","angulartics.google.analytics"]);h.config(["$routeProvider","$locationProvider",function(j,i){j.when("/",{templateUrl:"html/home.html"}).when("/about",{templateUrl:"html/about.html"}).when("/events",{templateUrl:"html/events.html"}).when("/weekly",{templateUrl:"html/weekly.html"}).when("/initiative",{templateUrl:"html/initiative.html"}).when("/upcoming",{templateUrl:"html/upcoming.html"}).when("/news",{templateUrl:"html/news.html"}).when("/podcasts",{templateUrl:"html/podcasts.html"}).when("/contact",{templateUrl:"html/contact.html"}).when("/thankyou",{templateUrl:"html/thankyou.html"}).when("/blog",{templateUrl:"html/blog.html"}).otherwise({redirectTo:"/"})}]);h.service("selectedService",function(){var j;var l={};var i=function(){return j};var k=function(n,m,o){if(m&&o){if(!l[m]){l[m]=""}l[m]=o}j=n;angular.forEach(l,function(q,p){})};return{getSelected:i,setSelected:k}});function c(i){var j;switch(i){case 0:j="January";break;case 1:j="February";break;case 2:j="March";break;case 3:j="April";break;case 4:j="May";break;case 5:j="June";break;case 6:j="July";break;case 7:j="August";break;case 8:j="September";break;case 9:j="October";break;case 10:j="November";break;case 11:j="December";break;default:j="Date Input Error"}return j}function g(i){var j;switch(i){case 0:j="Sunday";break;case 1:j="Monday";break;case 2:j="Tuesday";break;case 3:j="Wednesday";break;case 4:j="Thursday";break;case 5:j="Friday";break;case 6:j="Saturday";break;default:j="Date Input Error"}return j}function f(k){var j=/^\s*(\d{4})-(\d\d)-(\d\d)\s*$/,i=new Date(NaN),m,l=j.exec(k);if(l){m=+l[2];i.setFullYear(l[1],m-1,l[3]);if(m!=i.getMonth()+1){i.setTime(NaN)}}return i}function e(j,i){return Math.ceil((i-j)/86400000)}function a(j,i){if(j.getFullYear()!=i.getFullYear()){return false}if(j.getMonth()!=i.getMonth()){return false}if(j.getDate()!=i.getDate()){return false}return true}function d(j,i){return j.date<i.date?-1:j.date>i.date?1:0}function b(){Logos.ReferenceTagging.lbsBibleVersion="ESV";Logos.ReferenceTagging.lbsLinksOpenNewWindow=true;Logos.ReferenceTagging.lbsLogosLinkIcon="dark";Logos.ReferenceTagging.lbsNoSearchTagNames=[];Logos.ReferenceTagging.lbsTargetSite="biblia";Logos.ReferenceTagging.lbsCssOverride=true;Logos.ReferenceTagging.tag()}h.controller("TopBar",["$scope","$route","$location","selectedService",function(s,q,o,r){s.go=function(i){o.path(i)};s.sideBarItems=[{name:"Home",url:"#/",label:false,path:""},{name:"About Us",url:"#/about",label:false,path:"about"},{name:"Ministries",url:"#/events",label:false,path:"events"},{name:"Weekly Ministries",url:"#/weekly#biblestudy",label:false,path:"weekly#biblestudy"},{name:"The Multiply Initiative",url:"#/initiative",label:false,path:"initiative"},{name:"Upcoming Ministry Events",url:"#/upcoming",label:false,path:"upcoming"},{name:"News/Updates",url:"#/news",label:false,path:"news"},{name:"Podcasts",url:"#/podcasts",label:false,path:"podcasts"},{name:"Contact",url:"#/contact",label:false,path:"contact"}];s.items=[{name:"Home",url:"#/"},{name:"About Us",url:"#/about"},{name:"Ministries",url:"#/events"},{name:"News/Updates",url:"#/news"},{name:"Podcasts",url:"#/podcasts"},{name:"Contact",url:"#/contact"}];s.itemsLeft=[{name:"Home",url:"#/",dropdown:false,nested:[]},{name:"About Us",url:"#/about",dropdown:false,nested:[]}];s.itemsRight=[{name:"News/Updates",url:"#/news"},{name:"Podcasts",url:"#/podcasts"},{name:"Contact",url:"#/contact"}];var l=function(){s.selected=r.getSelected()};for(var n=0;n<s.items.length;n++){if(s.items[n].url==document.location.hash){s.selected=s.items[n]}}s.select=function(i){s.ministrySelected=false;if(i.name==="Home"){window.open("#","_self")}else{if(i.name==="News/Updates"){window.open("#/news","_self")}else{q.reload()}}s.selected=i;$(".top-bar").removeClass("expanded");k()};var j=false;var m=$("body");m.addClass("slide-from-side-closed");s.toggleSlide=function(){k()};function p(){var i=window.orientation;if(j===true){k()}}window.addEventListener("orientationchange",p);var k=function(){if(j===false){m.removeClass("slide-from-side-closed");m.addClass("slide-from-side-open")}else{m.removeClass("slide-from-side-open");m.addClass("slide-from-side-closed")}j=!j}}]);h.controller("SlidesController",function(){console.log("SlidesController");$(function(){console.log("run after doc load")})});h.controller("JoyrideController",["$scope",function(i){i.tour=function(){console.log("joyride controller working!")}}]);h.controller("InitializeController",[function(){$(document).foundation()}]);h.controller("NewHomeController",["$scope",function(i){i.slides=[{url:"",src:"img/slide0-MainSlide.png"},{url:"#/about",src:"img/slide1-Welcome.png"},{url:"",src:"img/slide1-Welcome.png"}];i.bullets=[{number:0},{number:1},{number:2}];i.selectedBullet=i.bullets[0];var j=Swipe(document.getElementById("slider"),{startSlide:0,speed:400,auto:5000,continuous:true,disableScroll:false,stopPropagation:false,callback:function(k,l){i.changeActive(k)},transitionEnd:function(k,l){}});i.changeActive=function(k){i.selectedBullet=i.bullets[k];if(!i.$$phase){i.$apply()}};i.click=function(k){i.selectedBullet=i.bullets[k.number];j.slide(k.number)};i.prevSlide=function(){j.prev()};i.nextSlide=function(){j.next()}}]);h.controller("HomeController",["$scope","httpService",function(j,l){var k="$$Upcoming Ministry Events";var i={};j.nextEvent;l.getLabeledPostRecursive(k).then(function(q,m,r,o){var n=new Date();angular.forEach(q.items,function(A,B){var t=A.title.indexOf(":");var s=A.title.substr(0,t);var z=A.title.substr(t+1,A.title.length);var w=f(s);var y=w.getDate();var u=g(w.getDay());var v=c(w.getMonth());var x=w.getFullYear();A.title=z;A.date=w;A.dateText=u+", "+v+" "+y;if(n>w){}else{if(x){if(!i[w]){i[w]=A}}}});var p;angular.forEach(i,function(t,s){if(!p){p=t.date}else{if(p>t.date){p=t.date}}});j.nextEvent=i[p]}).then(function(){l.resetRecursiveGet();var n="$News/Updates";j.currentNews;var o=new Array();var m=new Array();var p=new Array();var q={0:{title:"Current News/Updates",data:{}}};l.getLabeledPostRecursive(n).then(function(v,r,w,t){var s=new Date();angular.forEach(v.items,function(H,I){var z=H.title.indexOf(":");var y=H.title.substr(0,z);var G=H.title.substr(z+1,H.title.length);var D=f(y);var F=D.getDate();var A=g(D.getDay());var B=c(D.getMonth());var E=D.getFullYear();H.title=G;H.date=D;H.dateText="For "+A+", "+B+" "+F;if(H.labels.indexOf("Sunday School Update")>=0||H.labels.indexOf("Bible Study Update")>=0){var J=new Date(H.date.getTime()-(7*24*60*60*1000));H.date=J}var x=new Date(H.date.getTime()+(8*24*60*60*1000));var C=new Date(H.date.getTime()+(1*24*60*60*1000));if(H.date>s){}else{if(s>x){}else{if(H.labels.indexOf("Sunday School Update")>=0||H.labels.indexOf("Bible Study Update")>=0){if(s>C){m.push(H)}}else{m.push(H)}}}});q[0].data=m;angular.forEach(q,function(y,x){y.data.sort(d);y.data.reverse()});j.currentNews=q[0].data;angular.element(document).foundation("orbit",{});var u=(angular.element(".orbit-container img").first().height()+20);angular.element(".orbit-slides-container").css({"min-height":u});b()})})}]);h.controller("AboutController",["$scope","httpService",function(k,m){k.options=[{value:0,title:"temp",content:"temp"},{value:1,title:"temp",content:"temp"}];k.switchOption=function(){if(k.currentOption!=null){if(k.currentOption.value===0){k.getMissionStatement()}else{if(k.currentOption.value===1){k.getOurYouthPastor()}}k.swipe.slide(k.currentOption.value)}};k.callback=function(n){k.currentOption=k.options[n];if(!k.$$phase){k.$apply()}};var j={missionStatement:{},ourYouthPastor:{}};var l;var i;m.getLabeledPost("$About Us").success(function(p,n,r,o){if(p.items[0]&&p.items[1]){var q=p.items[0].labels[0];if(q.substr(0,1)==="$"){k.title=q.substr(1,q.length)}else{k.title="Page Error";return""}if(p.items[0].title==="Our Youth Pastor"){i=p.items[0];l=p.items[1]}else{i=p.items[1];l=p.items[0]}j.missionStatement.title=l.title;j.missionStatement.content=l.content;j.ourYouthPastor.title=i.title;j.ourYouthPastor.content=i.content;k.getMissionStatement();k.options[0].title=l.title;k.options[0].content=l.content;k.options[0].img="img/Smushed/about-us-1-banner.jpg";k.options[1].title=i.title;k.options[1].content=i.content;k.options[1].img="img/Smushed/about-us-2-banner.jpg";k.currentOption=k.options[0];k.createSwipe()}else{k.title="Page Error"}}).error(function(p,n,q,o){});k.getMissionStatement=function(){k.subtitle=j.missionStatement.title;k.content=j.missionStatement.content;k.img="img/Smushed/about-us-1-banner.jpg";k.isMissionStatement=true;k.isOurYouthPastor=false};k.getOurYouthPastor=function(){k.subtitle=j.ourYouthPastor.title;k.content=j.ourYouthPastor.content;k.img="img/Smushed/about-us-2-banner.jpg";k.isMissionStatement=false;k.isOurYouthPastor=true}}]);h.controller("WeeklyController",["$scope","httpService",function(l,m){l.options=[{value:0,title:"temp",content:"temp"},{value:1,title:"temp",content:"temp"}];l.switchOption=function(){if(l.currentOption!=null){if(l.currentOption.value===0){l.getBibleStudyTemplate()}else{if(l.currentOption.value===1){l.getSundaySchoolTemplate()}}l.swipe.slide(l.currentOption.value)}};l.callback=function(n){l.currentOption=l.options[n];if(!l.$$phase){l.$apply()}};var j={bibleStudy:{},sundaySchool:{}};var k;var i;m.getLabeledPost("$$Weekly Ministries").success(function(p,n,r,o){if(p.items[0]&&p.items[1]){var q=p.items[0].labels[0];if(q.substr(0,2)==="$$"){l.title="Weekly Ministries"}else{l.title="Page Error";return""}if(p.items[0].title==="Weekly Bible Study"){k=p.items[0];i=p.items[1]}else{k=p.items[1];i=p.items[0]}j.sundaySchool.title=i.title;j.sundaySchool.content=i.content;j.bibleStudy.title=k.title;j.bibleStudy.content=k.content;l.getBibleStudyTemplate();l.options[0].title=i.title;l.options[0].content=i.content;l.options[0].img="img/Smushed/weekly-2-banner.jpg";l.options[0].mapLink="https://maps.google.com/maps?q=1411+kennoway+park,+Spring+TX,+77379&hl=en&sll=31.168934,-100.076842&sspn=10.237092,8.76709&hnear=1411+Kennoway+Park+Dr,+Spring,+Texas+77379&t=m&z=16";l.options[0].mapImg="http://maps.googleapis.com/maps/api/staticmap?center=24724+Aldine+Westfield+Rd,+Spring,+Texas+77373&zoom=13&size=600x300&maptype=roadmap&markers=color:red%7Ccolor:red%7Clabel:A%7C24724+Aldine+Westfield+Rd,+Spring,+Texas+77373&sensor=false";l.options[1].title=k.title;l.options[1].content=k.content;l.options[1].img="img/Smushed/weekly-1-banner.jpg";l.options[1].mapLink="https://maps.google.com/maps?q=24724+aldine+westfield,+spring+TX,+77373&hl=en&ll=30.065213,-95.401046&spn=0.010047,0.01457&sll=31.168934,-100.076842&sspn=10.762073,12.436523&hnear=24724+Aldine+Westfield+Rd,+Spring,+Texas+77373&t=m&z=16";l.options[1].mapImg="http://maps.googleapis.com/maps/api/staticmap?center=1411+kennoway+park,+Spring+TX,+77379&zoom=14&size=600x300&maptype=roadmap&markers=color:red%7Ccolor:red%7Clabel:A%7C1411+kennoway+park,+Spring+TX,+77379&sensor=false";l.currentOption=l.options[0];l.createSwipe()}else{l.title="Page Error"}}).error(function(p,n,q,o){});l.getBibleStudyTemplate=function(){l.image="img/Smushed/weekly-1-banner.jpg";l.subtitle=j.bibleStudy.title;l.content=j.bibleStudy.content;l.mapLink="https://maps.google.com/maps?q=1411+kennoway+park,+Spring+TX,+77379&hl=en&sll=31.168934,-100.076842&sspn=10.237092,8.76709&hnear=1411+Kennoway+Park+Dr,+Spring,+Texas+77379&t=m&z=16";l.mapImg="http://maps.googleapis.com/maps/api/staticmap?center=1411+kennoway+park,+Spring+TX,+77379&zoom=14&size=600x300&maptype=roadmap&markers=color:red%7Ccolor:red%7Clabel:A%7C1411+kennoway+park,+Spring+TX,+77379&sensor=false";l.isBibleStudy=true;l.isSundaySchool=false};l.getSundaySchoolTemplate=function(){l.image="img/Smushed/weekly-2-banner.jpg";l.subtitle=j.sundaySchool.title;l.content=j.sundaySchool.content;l.mapLink="https://maps.google.com/maps?q=24724+aldine+westfield,+spring+TX,+77373&hl=en&ll=30.065213,-95.401046&spn=0.010047,0.01457&sll=31.168934,-100.076842&sspn=10.762073,12.436523&hnear=24724+Aldine+Westfield+Rd,+Spring,+Texas+77373&t=m&z=16";l.mapImg="http://maps.googleapis.com/maps/api/staticmap?center=24724+Aldine+Westfield+Rd,+Spring,+Texas+77373&zoom=13&size=600x300&maptype=roadmap&markers=color:red%7Ccolor:red%7Clabel:A%7C24724+Aldine+Westfield+Rd,+Spring,+Texas+77373&sensor=false";l.isBibleStudy=false;l.isSundaySchool=true}}]);h.controller("InitiativeController",["$scope","httpService",function(s,u){s.options=[];function w(E){for(var D=0;D<E;D++){s.options.push({value:D,title:"temp"+D,dateText:"temp"+D,content:"temp"+D})}}var q=300;var x=30;var A=0;var r=0;var C=x;var i=C+x+2;var z=0;var l={};w(q);s.switchOption=function(){if(s.currentOption!=null){s.swipe.slide(s.currentOption.shiftedIndex)}};var t=false;function m(){z++;if(i===l.length){angular.forEach(l,function(F,E){if(E>C+2&&E<i){s.options[E-C+3].title=F.title;s.options[E-C+3].dateText=F.dateText;s.options[E-C+3].content=F.content}});var D=x-(i-r)+2;s.swipe.slide(D,1);t=true}else{angular.forEach(l,function(F,E){if(E>C&&E<i){s.options[E-C+1].title=F.title;s.options[E-C+1].dateText=F.dateText;s.options[E-C+1].content=F.content}});A=C;r=i;i+=x-1;if(i>l.length){i=l.length;C=i-x}else{C+=x-1}}if(!s.$$phase){s.$apply()}if(!t){s.swipe.slide(3,1)}else{}}function y(){z--;var D=A-x+1;angular.forEach(l,function(F,E){if(E>D&&E<(r-x+1)){s.options[E-D+1].title=F.title;s.options[E-D+1].dateText=F.dateText;s.options[E-D+1].content=F.content}});C=A;i=r;r-=x-1;A-=x-1;if(!t){s.swipe.slide(x+1,1)}else{t=false}}var j=1;s.callback=function(D){console.log("skipIndex",z);console.log("official index",D);if(D>1){if(t){j=C+D-3}else{j=(z*x)+D;if(j<0){j=D}}}else{j=D}console.log("currentIndex",j);s.currentOption=s.mainTabs[o[j]];p[v].isActive=false;p[s.currentOption.index].isActive=true;v=s.currentOption.index;j=D;if(D===1){s.subtitle="About"}else{s.subtitle="Meditations"}if(D===x+2){if(s.options[D].dateText!=l[l.length-1].dateText){m()}}if(A>0){if(!t&&D===2){console.log("jump back all the way!");y()}else{if(t&&D===(x-(C-A)+3)){console.log("jump back a little!");y()}else{}}console.log("reached the beginning!")}if(!s.$$phase){s.$apply()}};var n="$$The Multiply Initiative";s.title=n.substr(2,n.length);s.subtitle="Meditations";var k=f("2013-10-20");var v=1;var p={0:{index:0,title:"Today's Meditation",isActive:false,data:{}},1:{index:1,title:"The Multiply Initiative",isActive:true,data:{}}};var o={0:0,1:1};var B={};s.loadTemplate=function(E){console.log("index",E);console.log("index >>",p[E].shiftedIndex);console.log("activeIndex >>",p[v].shiftedIndex);console.log("index>> - activeIndex >>",p[E].shiftedIndex-p[v].shiftedIndex);console.log("/ visibleKeys",(p[E].shiftedIndex-p[v].shiftedIndex)/x);var G=(p[E].shiftedIndex-p[v].shiftedIndex)/x;p[v].isActive=false;p[E].isActive=true;v=E;var F=p[E].shiftedIndex;console.log("skipTimes",G);function D(I){if(I>=1){m();D(I-1)}else{var J=F-A;if(J>x){m();J=F-C;s.swipe.slide(J+3)}else{s.swipe.slide(J+1)}}}function H(I){if(I>=1){y();H(I-1)}else{console.log("prevFirstKey",A);console.log("nextFirstKey",C);console.log("newIndex",F);var J=F-C;console.log("move left :",J,F-C);if(J>x){y();J=F-C;console.log("prevFirstKey",A);console.log("nextFirstKey",C);console.log("move left :",J,F-C);s.swipe.slide(J+3)}else{console.log("mainTabs",p);s.swipe.slide(J+1)}}}if(E<2){s.swipe.slide(E)}else{if(G<0){console.log("SKIP BACK!!");H(Math.abs(G))}else{D(G)}}};u.getLabeledPost("$$$The Multiply Initiative").success(function(F,D,G,E){if(F.items[0]){p[1].title=F.items[0].title;p[1].data=new Array(F.items[0]);s.options[1].title=F.items[0].title;s.options[1].dateText=F.items[0].dateText;s.options[1].content=F.items[0].content}}).error(function(F,D,G,E){});u.getLabeledPostRecursive("$$$Meditations").then(function(K,I,E,F){var N=new Date();var R=-1;var S;var D={};var O=0;var P=0;var Q=true;angular.forEach(K.items,function(ac,ad){var V=ac.title.indexOf(":");var U=ac.title.substr(0,V);var ab=ac.title.substr(V+1,ac.title.length);var Y=f(U);var aa=Y.getDate();var W=g(Y.getDay());var X=c(Y.getMonth());var Z=Y.getFullYear();ac.title=ab;ac.date=Y;ac.dateText=W+", "+X+" "+aa;if(!S){S=Y}else{if(Y>S){S=Y}}D[Y]=ac;if(a(N,Y)){var T=Math.ceil(e(k,Y)/7);if(T>R){R=T}if(!B[T]){B[T]={data:new Array()}}B[T].data.push(ac);p[0].data=new Array(ac);s.options[0].title=ac.title;s.options[0].dateText=ac.dateText;s.options[0].content=ac.content;Q=false;if(s.options[ad-O+2]){s.options[ad-O+2].title=ac.title;s.options[ad-O+2].dateText=ac.dateText;s.options[ad-O+2].content=ac.content;P=ad}else{console.log("ERROR: $scope.options is not large enough")}}else{if(Y<=N){var T=Math.ceil(e(k,Y)/7);if(T>R){R=T}if(!B[T]){B[T]={data:new Array()}}B[T].data.push(ac);if(Q){if(s.options[0].d){if(Y>s.options[0].d){s.options[0].title=ac.title;s.options[0].dateText=ac.dateText;s.options[0].content=ac.content;s.options[0].d=Y}}else{s.options[0].title=ac.title;s.options[0].dateText=ac.dateText;s.options[0].content=ac.content;s.options[0].d=Y}}if(s.options[ad-O+2]){s.options[ad-O+2].title=ac.title;s.options[ad-O+2].dateText=ac.dateText;s.options[ad-O+2].content=ac.content;P=ad}else{console.log("ERROR: $scope.options is not large enough")}}else{O+=1}}});l=angular.copy(s.options);l.splice(P+3,q-P);s.options.splice(x+3,q-x);if(!p[0].data[0]){p[0].data=new Array(D[S])}var L=0;for(var J=2;J<R+2;J++){var G=R+2-J;if(p[J]){p[J]={}}if(!B[G]){B[G]={data:new Array()}}if(J===2){L=J}p[J]={index:J,shiftedIndex:L,title:"Week "+G,isActive:false,data:B[G].data};for(var H=L;H<L+B[G].data.length;H++){o[H]=J}L+=B[G].data.length}p[0].shiftedIndex=0;p[1].shiftedIndex=1;angular.forEach(p,function(U,T){U.data.sort(d);U.data.reverse()});var M=new Array();angular.forEach(p,function(U,T){M.push(U)});s.createSwipe();s.mainTabs=M;s.swipe.slide(1)})}]);h.controller("UpcomingController",["$scope","httpService",function(i,n){i.callback=function(o){};var m=function(p){p.imgLarge="img/Smushed/upcoming-default.jpg";p.visible=true;for(var o=0;o<p.labels.length;o++){if(p.title.indexOf("Multiply Beach")>-1){p.imgSmall="img/Smushed/upcoming-beach.jpg";p.imgLarge="img/Smushed/upcoming-beach.jpg";break}else{if(p.title.indexOf("Crawdad")>-1){p.imgSmall="img/Smushed/upcoming-crawdad-small.jpg";p.imgLarge="img/Smushed/upcoming-crawdad.jpg";p.visible=false;break}else{if(p.title.indexOf("Summer Lock-In")>-1){p.imgSmall="img/Smushed/upcoming-lock-in.jpg";p.imgLarge="img/Smushed/upcoming-lock-in.jpg";break}else{if(p.labels[o]==="Evangelism"){p.imgSmall="img/Smushed/upcoming-evangelism.jpg";p.imgLarge="img/Smushed/upcoming-evangelism.jpg";break}else{if(p.labels[o]==="Afterglow"){break}else{if(p.labels[o]==="Afterglow"){break}else{if(p.labels[o]==="Afterglow"){break}else{}}}}}}}}};var k="$$Upcoming Ministry Events";i.title=k.substr(2,k.length);var l={};var j={};i.allUpcomingEvents;n.getLabeledPostRecursive(k).then(function(r,o,s,q){var p=new Date();console.log("data",r);angular.forEach(r.items,function(B,C){var u=B.title.indexOf(":");var t=B.title.substr(0,u);var A=B.title.substr(u+1,B.title.length);var x=f(t);x.setDate(x.getDate()+1);var z=x.getDate();var v=g(x.getDay());var w=c(x.getMonth());var y=x.getFullYear();B.title=A;B.date=x;B.dateText=v+", "+w+" "+z;m(B);if(p>x){if(!j[y]){j[y]={year:y,events:new Array()}}j[y].events.push(B)}else{if(y){if(!l[y]){l[y]={year:y,events:new Array()}}l[y].events.push(B)}}});angular.forEach(l,function(u,t){u.events.sort(d)});i.allUpcomingEvents=l;console.log("$scope",i)})}]);h.controller("NewsController",["$scope","httpService",function(q,o){q.options=[];function i(t){for(var s=0;s<t;s++){q.options.push({value:s,title:"temp"+s,dateText:"temp"+s,content:"temp"+s})}}var m=300;i(m);q.switchOption=function(s){if(q.currentOption!=null){if(q.currentOption===q.selectOptions[0]){q.loadTemplate(0)}else{if(q.currentOption===q.selectOptions[1]){q.loadTemplate(1)}else{}}}};q.callback=function(s){if(s<j[0].data.length){j[r].isActive=false;j[0].isActive=true;r=0;q.currentOption=q.selectOptions[0]}else{if(s>=j[0].data.length){j[r].isActive=false;j[1].isActive=true;r=1;q.currentOption=q.selectOptions[1]}else{}}if(!q.$$phase){q.$apply()}};var n="$News/Updates";q.title=n.substr(1,n.length);q.allNews;var k=new Array();var l=new Array();var p=new Array();var r=0;var j={0:{title:"Current News/Updates",isActive:false,data:{}},1:{title:"Old News/Updates",isActive:false,data:{}}};q.selectOptions=[{title:"Current News/Updates"},{title:"Old News/Updates"}];q.mainTabs=j;q.loadTemplate=function(s){j[r].isActive=false;j[s].isActive=true;r=s;if(s===0){q.currentOption=q.selectOptions[0];q.swipe.slide(0)}else{q.currentOption=q.selectOptions[1];q.swipe.slide(j[0].data.length)}};o.resetRecursiveGet();o.getLabeledPostRecursive(n).then(function(x,t,y,v){var u=new Date();angular.forEach(x.items,function(J,K){var B=J.title.indexOf(":");var A=J.title.substr(0,B);var I=J.title.substr(B+1,J.title.length);var F=f(A);var H=F.getDate();var C=g(F.getDay());var D=c(F.getMonth());var G=F.getFullYear();J.title=I;J.date=F;J.dateText="For "+C+", "+D+" "+H;if(J.labels.indexOf("Sunday School Update")>=0||J.labels.indexOf("Bible Study Update")>=0){var L=new Date(J.date.getTime()-(7*24*60*60*1000));J.date=L}var z=new Date(J.date.getTime()+(8*24*60*60*1000));var E=new Date(J.date.getTime()+(1*24*60*60*1000));J.nextWeek=z;J.nextDay=E;if(J.date>u){k.push(J)}else{if(u>z){p.push(J)}else{if(J.labels.indexOf("Sunday School Update")>=0||J.labels.indexOf("Bible Study Update")>=0){if(u>E){l.push(J)}}else{l.push(J)}}}});j[0].data=l;j[1].data=p;angular.forEach(j,function(A,z){A.data.sort(d);A.data.reverse()});var s=0;angular.forEach(j[0].data,function(A,z){q.options[z].title=A.title;q.options[z].dateText=A.dateText;q.options[z].content=A.content;if(z>s){s=z}});s++;var w=0;angular.forEach(j[1].data,function(A,z){q.options[j[0].data.length+z].title=A.title;q.options[j[0].data.length+z].dateText=A.dateText;q.options[j[0].data.length+z].content=A.content;if(z>w){w=z}});w++;s+=w;q.createSwipe();q.options.splice(s,q.options.length-s);q.loadTemplate(r)})}]);h.controller("PodcastsController",["$scope","httpService",function(i,n){angular.element("#audioPlayer").audioPlayer({classPrefix:"audioplayer",strPlay:"Play",strPause:"Pause",strVolume:"Volume"});var k=document.getElementById("audioPlayer");function l(o){k.src=o;k.load()}function m(){k.play()}i.callback=function(o){};i.playThis=function(o){if(i.allPodcasts){if(i.allPodcasts[o]){i.currentSermon=i.allPodcasts[o];var p=i.allPodcasts[o].dblink;l(p);i.prevSlide();m()}}};i.searchTypes=[{type:"By Title"},{type:"By Speaker"},{type:"By Series"}];i.searchType=i.searchTypes[0];i.show={title:true,speaker:false,series:false};i.switchType=function(){i.show.title=false;i.show.speaker=false;i.show.series=false;switch(i.searchType.type){case"By Title":i.show.title=true;break;case"By Speaker":i.show.speaker=true;break;case"By Series":i.show.series=true;break;default:break}};var j="$Podcasts";i.title=j.substr(1,j.length);i.allPodcasts={};n.getLabeledPost(j).success(function(t,o,u,q){if(t.items[0]){var p=t.items[0].content;var s=p.toString();if(s){var r=JSON.parse(s);if(r){angular.forEach(r,function(w,v){var x=f(w.date);w.dayNumber=x.getDate();w.day=g(x.getDay());w.month=c(x.getMonth());if(isNaN(w.dayNumber)){w.month="No Date";w.dayNumber="";w.day=""}else{w.date=w.month+" "+w.dayNumber+", "+x.getFullYear()}});i.allPodcasts=r;if(i.allPodcasts){i.currentSermon=i.allPodcasts[0];if(i.currentSermon){l(i.currentSermon.dblink);i.createSwipe()}}}}}}).error(function(q,o,r,p){})}]);h.controller("ContactController",["$scope","httpService",function(i,j){j.getLabeledPost("$Contact").success(function(n,k,o,l){if(n.items[0]){var m=n.items[0];i.title=m.title;i.content=m.content}else{i.title="Page Error"}b()}).error(function(m,k,n,l){})}]);h.directive("swipejs",function(){return function(k,j,i){k.createSwipe=function(){k.swipe=Swipe(j[0],{startSlide:0,speed:400,auto:0,continuous:false,disableScroll:false,stopPropagation:false,callback:function(l,m){},transitionEnd:function(l,m){k.callback(l)}})};k.prevSlide=function(){k.swipe.prev()};k.nextSlide=function(){k.swipe.next()};$(document).keyup(function(l){if(l.which===37){k.prevSlide()}if(l.which===39){k.nextSlide()}})}});h.directive("swipeEvent",function(){return{restrict:"A",link:function(l,k,j,i){var m=true;l.createSwipe=function(){l.swipe=Swipe(k[0],{startSlide:0,speed:400,auto:0,continuous:false,disableScroll:false,stopPropagation:true,callback:function(n,o){},transitionEnd:function(n,o){}})};l.createSwipe();l.toggle=function(){if(m){l.swipe.next()}else{l.swipe.prev()}m=!m};l.prevSlide=function(){l.swipe.prev()};l.nextSlide=function(){l.swipe.next()}}}});h.directive("backImg",function(){return{restrict:"A",link:function(m,l,k,i){var j=k.backImg;m.setImg=function(){l.css({"background-image":"url("+j+")"})};m.setImg()}}});h.directive("newsItem",function(){return{restrict:"E",template:'<div class="expand-on-small panel hero shadowed-image"><div class="small-12 large-12 columns"><h3>{{news.title}}</h3><h4>{{news.dateText}}</h4><br/></div><div class="row transparent"><div class="small-12 large-12 columns"><div ng-bind-html="news.content" class="panel shadowed-image"></div></div></div></div>',replace:true,link:function(l,k,j,i){}}});h.directive("weeklyEvent",["$http","$compile","$location",function(k,i,j){return{restrict:"E",template:"<div></div>",controller:"weeklyController",link:function(o,m,l,q){var p=j.$$hash;var n="html/"+p+".html";if(p==="biblestudy"){o.isBibleStudy=true;o.isSundaySchool=false}else{if(p==="sundayschool"){o.isBibleStudy=false;o.isSundaySchool=true}}k.get(n).then(function(r){var s=r.data;m.html(s);i(m.contents())(o)});o.$watch("url",function(s,r){if(s){k.get(s).then(function(t){var u=t.data;m.html(u);i(m.contents())(o)})}})}}}]);h.directive("podcast",function(){return{restrict:"E",template:'<div class="podcasts small-12 large-12 columns panel shadowed-image"><div class="small-12 large-2 columns"><a href="#" class="button"><i class="foundiconacc-speaker"></i> Listen </a></div><div class="small-12 large-2 columns"><p>August 13, 2013</p></div><div class="small-12 large-6 columns"><h3>Nathan Ramirez</h3><h2>Final Camp Exhortation</h2></div><div class="small-12 large-2 columns"><a href="Nathan Camp Final Exortation.mp3"><i class="foundicongen-inbox"></i> Download </a></div></div>',link:function(){}}});h.directive("chosenPodcast",function(){return{restrict:"E",template:'<div style="height: 300px; background: #f5f4f0 url(\'img/Smushed/podcasts-art.jpg\') center top repeat-y; background-size: cover"><div class="small-12 medium-6 columns" style="height: 300px; overflow-y: scroll; color: #fff;"><h3 style="color: #fff;">{{currentSermon.title}}</h3><h4 style="color: #fff;">{{currentSermon.speaker}}</h4><h4 style="color: #fff;">{{currentSermon.series}}</h4><p>{{currentSermon.date}}</p><p><strong>Passage/Topic: {{currentSermon.passage}}</strong></p><p class="show-for-small">{{currentSermon.description}}</p></div><div class="hide-for-small small-12 medium-6 columns" style="height: 300px; overflow-y: scroll; color: #fff;"><p>{{currentSermon.description}}</p></div></div>',link:function(l,k,j,i){}}});h.controller("FeedCtrl",["$scope","httpService",function(i,j){i.loadButonText="Load";i.posts;j.getBlogPosts().success(function(m,k,n,l){console.log("posts",m);i.posts=m.items}).error(function(m,k,n,l){});j.getBlog().success(function(m,k,n,l){console.log("blog",m.items);i.blog=m.items}).error(function(m,k,n,l){})}]);h.service("httpService",["$http","$q",function(m,k){var o=this;var j="AIzaSyBwh5B3d-nVf8Ut6mf690Id5miFFQ01s0M";var i="1357003820482584675";o.getBlog=function(){var r="https://www.googleapis.com/blogger/v3/blogs/"+i+"?key="+j+"&callback=JSON_CALLBACK";return m.jsonp(r)};o.getBlogPosts=function(){var r="https://www.googleapis.com/blogger/v3/blogs/"+i+"/posts?maxPosts=9999&key="+j+"&callback=JSON_CALLBACK";return m.jsonp(r)};o.getLabeledPost=function(s){var r="https://www.googleapis.com/blogger/v3/blogs/"+i+"/posts?maxResults=20&labels="+s+"&fields=nextPageToken,items(title,published,labels,content)&key="+j+"&callback=JSON_CALLBACK";return m.jsonp(r)};var q={items:new Array()};var n;var p;var l=function(t,r){var s="https://www.googleapis.com/blogger/v3/blogs/"+i+"/posts?maxResults=20";if(r){s+="&pageToken="+r}s+="&labels="+n+"&fields=nextPageToken,items(title,published,labels,content)&key="+j+"&callback=JSON_CALLBACK";m.jsonp(s).success(function(w,u,x,v){q.items.push.apply(q.items,w.items);if(w.nextPageToken){l(n,w.nextPageToken)}else{p.resolve(q)}}).error(function(w,u,x,v){})};o.getLabeledPostRecursive=function(s,r){o.resetRecursiveGet();p=k.defer();n=s;l();return p.promise};o.resetRecursiveGet=function(){p=k.defer();n="";q={items:new Array()}}}])})();