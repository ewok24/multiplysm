(function(){function s(a){switch(a){case 0:a="January";break;case 1:a="February";break;case 2:a="March";break;case 3:a="April";break;case 4:a="May";break;case 5:a="June";break;case 6:a="July";break;case 7:a="August";break;case 8:a="September";break;case 9:a="October";break;case 10:a="November";break;case 11:a="December";break;default:a="Date Input Error"}return a}function t(a){switch(a){case 0:a="Sunday";break;case 1:a="Monday";break;case 2:a="Tuesday";break;case 3:a="Wednesday";break;case 4:a="Thursday";
break;case 5:a="Friday";break;case 6:a="Saturday";break;default:a="Date Input Error"}return a}function r(a){var b=new Date(NaN),c=/^\s*(\d{4})-(\d\d)-(\d\d)\s*$/.exec(a);c&&(a=+c[2],b.setFullYear(c[1],a-1,c[3]),a!=b.getMonth()+1&&b.setTime(NaN));return b}function v(a,b){return a.date<b.date?-1:a.date>b.date?1:0}function m(){Logos.ReferenceTagging.lbsBibleVersion="ESV";Logos.ReferenceTagging.lbsLinksOpenNewWindow=!0;Logos.ReferenceTagging.lbsLogosLinkIcon="dark";Logos.ReferenceTagging.lbsNoSearchTagNames=
[];Logos.ReferenceTagging.lbsTargetSite="biblia";Logos.ReferenceTagging.lbsCssOverride=!0;Logos.ReferenceTagging.tag()}$(function(){FastClick.attach(document.body)});var l=angular.module("msmApp",["ngRoute","ngSanitize","angulartics","angulartics.google.analytics"]);l.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"html/home.html"}).when("/about",{templateUrl:"html/about.html"}).when("/events",{templateUrl:"html/events.html"}).when("/weekly",{templateUrl:"html/weekly.html"}).when("/initiative",
{templateUrl:"html/initiative.html"}).when("/upcoming",{templateUrl:"html/upcoming.html"}).when("/news",{templateUrl:"html/news.html"}).when("/podcasts",{controller:"podcastsController",templateUrl:"html/podcasts.html"}).when("/contact",{templateUrl:"html/contact.html"}).when("/thankyou",{templateUrl:"html/thankyou.html"}).when("/blog",{templateUrl:"html/blog.html"}).otherwise({redirectTo:"/"})}]);l.service("selectedService",function(){var a,b={};return{getSelected:function(){return a},setSelected:function(c,
d,e){d&&e&&(b[d]||(b[d]=""),b[d]=e);a=c;angular.forEach(b,function(a,c){})}}});l.controller("TopBar",["$scope","$route","selectedService",function(a,b,c){a.items=[{name:"Home",url:"#/"},{name:"About Us",url:"#/about"},{name:"Ministries",url:"#/events"},{name:"News/Updates",url:"#/news"},{name:"Podcasts",url:"#/podcasts"},{name:"Contact",url:"#/contact"}];a.selected=a.items[0];a.select=function(c){"Home"===c.name?window.open("#","_self"):"News/Updates"===c.name?window.open("#/news","_self"):b.reload();
a.selected=c;$(".top-bar").removeClass("expanded");f()};var d=!1,e=$("body");e.addClass("slide-from-side-closed");a.toggleSlide=function(){f()};window.addEventListener("orientationchange",function(){!0===d&&f()});var f=function(){!1===d?(e.removeClass("slide-from-side-closed"),e.addClass("slide-from-side-open")):(e.removeClass("slide-from-side-open"),e.addClass("slide-from-side-closed"));d=!d}}]);l.controller("SlidesController",function(){console.log("SlidesController");$(function(){console.log("run after doc load")})});
l.controller("JoyrideController",["$scope",function(a){a.tour=function(){console.log("joyride controller working!")}}]);l.controller("InitializeController",[function(){$(document).foundation()}]);l.controller("podcastsController",["$scope",function(a){$("audio").mediaelementplayer();a.playThis=function(a){var c=new MediaElementPlayer("#podcastPlayer");c.pause();c.setSrc(a);c.play()}}]);l.controller("HomeController",["$scope","httpService",function(a,b){var c={};a.nextEvent;b.getLabeledPostRecursive("$$Upcoming Ministry Events").then(function(d,
e,f,b){var n=new Date;angular.forEach(d.items,function(a,e){var d=a.title.indexOf(":"),h=a.title.substr(0,d),d=a.title.substr(d+1,a.title.length),h=r(h),f=h.getDate(),b=t(h.getDay()),k=s(h.getMonth()),q=h.getFullYear();a.title=d;a.date=h;a.dateText=b+", "+k+" "+f;n>h||q&&(c[h]||(c[h]=a))});var q;angular.forEach(c,function(a,c){q?q>a.date&&(q=a.date):q=a.date});a.nextEvent=c[q]}).then(function(){b.resetRecursiveGet();a.currentNews;var c=[],e={0:{title:"Current News/Updates",data:{}}};b.getLabeledPostRecursive("$News/Updates").then(function(f,
b,n,q){var g=new Date;angular.forEach(f.items,function(a,e){var h=a.title.indexOf(":"),b=a.title.substr(0,h),h=a.title.substr(h+1,a.title.length),b=r(b),f=b.getDate(),n=t(b.getDay()),k=s(b.getMonth());b.getFullYear();a.title=h;a.date=b;a.dateText="For "+n+", "+k+" "+f;if(0<=a.labels.indexOf("Sunday School Update")||0<=a.labels.indexOf("Bible Study Update"))h=new Date(a.date.getTime()-6048E5),a.date=h;h=new Date(a.date.getTime()+6912E5);b=new Date(a.date.getTime()+864E5);a.date>g||g>h||(0<=a.labels.indexOf("Sunday School Update")||
0<=a.labels.indexOf("Bible Study Update")?g>b&&c.push(a):c.push(a))});e[0].data=c;angular.forEach(e,function(a,c){a.data.sort(v);a.data.reverse()});a.currentNews=e[0].data;angular.element(document).foundation("orbit",{animation:"slide",timer_speed:5E3,pause_on_hover:!1,resume_on_mouseout:!1,animation_speed:250,stack_on_small:!1,navigation_arrows:!1,slide_number:!1,bullets:!0,timer:!0,variable_height:!0,container_class:"orbit-container"});f=angular.element(".orbit-container img").first().height()+
20;angular.element(".orbit-slides-container").css({"min-height":f});m()})})}]);l.controller("AboutController",["$scope","httpService",function(a,b){var c,d,e,f,k,n;b.getLabeledPost("$About Us").success(function(b,g,l,p){if(b.items[0]&&b.items[1]){g=b.items[0].labels[0];if("$"===g.substr(0,1))a.title=g.substr(1,g.length);else return a.title="Page Error","";"Our Youth Pastor"===b.items[0].title?(n=b.items[0],k=b.items[1]):(n=b.items[1],k=b.items[0]);c=k.title;d=k.content;e=n.title;f=n.content;a.getMissionStatement();
m()}else a.title="Page Error"}).error(function(a,c,b,e){});a.getMissionStatement=function(){a.subtitle=c;a.content=d;a.isMissionStatement=!0;a.isOurYouthPastor=!1;m()};a.getOurYouthPastor=function(){a.subtitle=e;a.content=f;a.isMissionStatement=!1;a.isOurYouthPastor=!0;m()}}]);l.controller("WeeklyController",["$scope","httpService",function(a,b){var c,d,e,f,k,n;b.getLabeledPost("$$Weekly Ministries").success(function(b,g,l,p){if(b.items[0]&&b.items[1]){if("$$"===b.items[0].labels[0].substr(0,2))a.title=
"Weekly Ministries";else return a.title="Page Error","";"Weekly Bible Study"===b.items[0].title?(k=b.items[0],n=b.items[1]):(k=b.items[1],n=b.items[0]);e=n.title;f=n.content;c=k.title;d=k.content;a.getBibleStudyTemplate();m()}else a.title="Page Error"}).error(function(a,b,c,e){});a.getBibleStudyTemplate=function(){a.image="img/Revelation_s.png";a.subtitle=c;a.content=d;a.mapLink="https://maps.google.com/maps?q=1411+kennoway+park,+Spring+TX,+77379&hl=en&sll=31.168934,-100.076842&sspn=10.237092,8.76709&hnear=1411+Kennoway+Park+Dr,+Spring,+Texas+77379&t=m&z=16";
a.mapImg="http://maps.googleapis.com/maps/api/staticmap?center=1411+kennoway+park,+Spring+TX,+77379&zoom=14&size=600x300&maptype=roadmap&markers=color:red%7Ccolor:red%7Clabel:A%7C1411+kennoway+park,+Spring+TX,+77379&sensor=false";a.isBibleStudy=!0;a.isSundaySchool=!1};a.getSundaySchoolTemplate=function(){a.image="img/proverbs_s.png";a.subtitle=e;a.content=f;a.mapLink="https://maps.google.com/maps?q=24724+aldine+westfield,+spring+TX,+77373&hl=en&ll=30.065213,-95.401046&spn=0.010047,0.01457&sll=31.168934,-100.076842&sspn=10.762073,12.436523&hnear=24724+Aldine+Westfield+Rd,+Spring,+Texas+77373&t=m&z=16";
a.mapImg="http://maps.googleapis.com/maps/api/staticmap?center=24724+Aldine+Westfield+Rd,+Spring,+Texas+77373&zoom=13&size=600x300&maptype=roadmap&markers=color:red%7Ccolor:red%7Clabel:A%7C24724+Aldine+Westfield+Rd,+Spring,+Texas+77373&sensor=false";a.isBibleStudy=!1;a.isSundaySchool=!0}}]);l.controller("InitiativeController",["$scope","httpService",function(a,b){a.title="$$The Multiply Initiative".substr(2,25);var c=r("2013-10-20"),d=0,e={0:{index:0,title:"Today's Meditation",isActive:!1,data:{}},
1:{index:1,title:"The Multiply Initiative",isActive:!1,data:{}}},f={};a.image="img/NT_EPISTLES.png";a.loadTemplate=function(b,c){e[d].isActive=!1;e[c].isActive=!0;d=c;a.hasImage=1===c?!1:!0;1<c&&(7>parseInt(e[c].title.substr(5,e[c].title.length-5))?a.image="img/EcclesiatesXL.png":a.image="img/NT_EPISTLES.png");a.displayed=b;m()};b.getLabeledPost("$$$The Multiply Initiative").success(function(a,b,c,d){a.items[0]&&(e[1].title=a.items[0].title,e[1].data=Array(a.items[0]))}).error(function(a,b,c,e){});
b.getLabeledPostRecursive("$$$Meditations").then(function(b,d,l,g){console.log("data",b);var u=new Date,p=-1,h,m={};angular.forEach(b.items,function(a,b){var d=a.title.indexOf(":"),g=a.title.substr(0,d),d=a.title.substr(d+1,a.title.length),g=r(g),n=g.getDate(),k=t(g.getDay()),l=s(g.getMonth());g.getFullYear();a.title=d;a.date=g;a.dateText=k+", "+l+" "+n;h?g>h&&(h=g):h=g;m[g]=a;u.getFullYear()==g.getFullYear()&&u.getMonth()==g.getMonth()&&u.getDate()==g.getDate()?(d=Math.ceil(Math.ceil((g-c)/864E5)/
7),d>p&&(p=d),f[d]||(f[d]={data:[]}),f[d].data.push(a),e[0].data=Array(a)):g<=u&&(d=Math.ceil(Math.ceil((g-c)/864E5)/7),d>p&&(p=d),f[d]||(f[d]={data:[]}),f[d].data.push(a))});e[0].data[0]||(e[0].data=Array(m[h]));for(b=2;b<p+2;b++)d=p+2-b,e[b]&&(e[b]={}),f[d]||(f[d]={data:[]}),e[b]={index:b,title:"Week "+d,isActive:!1,data:f[d].data};angular.forEach(e,function(a,b){a.data.sort(v);a.data.reverse()});var w=[];angular.forEach(e,function(a,b){w.push(a)});a.mainTabs=w;a.loadTemplate(e[1].data,1)})}]);
l.controller("UpcomingController",["$scope","httpService",function(a,b){a.title="$$Upcoming Ministry Events".substr(2,26);var c={},d={};a.allUpcomingEvents;b.getLabeledPostRecursive("$$Upcoming Ministry Events").then(function(b,f,k,n){var l=new Date;angular.forEach(b.items,function(a,b){var e=a.title.indexOf(":"),h=a.title.substr(0,e),e=a.title.substr(e+1,a.title.length),h=r(h),f=h.getDate(),n=t(h.getDay()),k=s(h.getMonth()),m=h.getFullYear();a.title=e;a.date=h;a.dateText=n+", "+k+" "+f;l>h?(d[m]||
(d[m]={year:m,events:[]}),d[m].events.push(a)):m&&(c[m]||(c[m]={year:m,events:[]}),c[m].events.push(a))});angular.forEach(c,function(a,b){a.events.sort(v)});a.allUpcomingEvents=c;m()})}]);l.controller("NewsController",["$scope","httpService",function(a,b){a.title="$News/Updates".substr(1,13);a.allNews;var c=[],d=[],e=[],f=0,k={0:{title:"Current News/Updates",isActive:!1,data:{}},1:{title:"Old News/Updates",isActive:!1,data:{}}};a.mainTabs=k;a.loadTemplate=function(b,c){k[f].isActive=!1;k[c].isActive=
!0;f=c;a.allNews=b;m()};b.resetRecursiveGet();b.getLabeledPostRecursive("$News/Updates").then(function(b,l,g,u){console.log("data",b);var p=new Date;angular.forEach(b.items,function(a,b){var f=a.title.indexOf(":"),g=a.title.substr(0,f),f=a.title.substr(f+1,a.title.length),g=r(g),k=g.getDate(),n=t(g.getDay()),l=s(g.getMonth());g.getFullYear();a.title=f;a.date=g;a.dateText="For "+n+", "+l+" "+k;if(0<=a.labels.indexOf("Sunday School Update")||0<=a.labels.indexOf("Bible Study Update"))f=new Date(a.date.getTime()-
6048E5),a.date=f;f=new Date(a.date.getTime()+6912E5);g=new Date(a.date.getTime()+864E5);a.nextWeek=f;a.nextDay=g;a.date>p?c.push(a):p>f?e.push(a):0<=a.labels.indexOf("Sunday School Update")||0<=a.labels.indexOf("Bible Study Update")?p>g&&d.push(a):d.push(a)});k[0].data=d;k[1].data=e;angular.forEach(k,function(a,b){a.data.sort(v);a.data.reverse()});a.loadTemplate(k[0].data,f);m()})}]);l.controller("ContactController",["$scope","httpService",function(a,b){b.getLabeledPost("$Contact").success(function(b,
d,e,f){b.items[0]?(b=b.items[0],a.title=b.title,a.content=b.content):a.title="Page Error";m()}).error(function(a,b,e,f){})}]);l.directive("newsItem",function(){return{restrict:"E",template:'<div class="expand-on-small panel hero shadowed-image"><div class="small-12 large-12 columns"><h3>{{news.title}}</h3><h4>{{news.dateText}}</h4><br/></div><div class="row transparent"><div class="small-12 large-12 columns"><div ng-bind-html="news.content" class="panel shadowed-image"></div></div></div></div>',replace:!0,
link:function(a,b,c,d){}}});l.directive("weeklyEvent",["$http","$compile","$location",function(a,b,c){return{restrict:"E",template:"<div></div>",controller:"weeklyController",link:function(d,e,f,k){f=c.$$hash;"biblestudy"===f?(d.isBibleStudy=!0,d.isSundaySchool=!1):"sundayschool"===f&&(d.isBibleStudy=!1,d.isSundaySchool=!0);a.get("html/"+f+".html").then(function(a){e.html(a.data);b(e.contents())(d)});d.$watch("url",function(c,f){c&&a.get(c).then(function(a){e.html(a.data);b(e.contents())(d)})})}}}]);
l.directive("podcast",function(){return{restrict:"E",template:'<div class="podcasts small-12 large-12 columns panel shadowed-image"><div class="small-12 large-2 columns"><a href="#" class="button"><i class="foundiconacc-speaker"></i> Listen </a></div><div class="small-12 large-2 columns"><p>August 13, 2013</p></div><div class="small-12 large-6 columns"><h3>Nathan Ramirez</h3><h2>Final Camp Exhortation</h2></div><div class="small-12 large-2 columns"><a href="Nathan Camp Final Exortation.mp3"><i class="foundicongen-inbox"></i> Download </a></div></div>',
link:function(){}}});l.controller("FeedCtrl",["$scope","httpService",function(a,b){a.loadButonText="Load";a.posts;b.getBlogPosts().success(function(b,d,e,f){console.log("posts",b);a.posts=b.items}).error(function(a,b,e,f){});b.getBlog().success(function(b,d,e,f){console.log("blog",b.items);a.blog=b.items}).error(function(a,b,e,f){})}]);l.service("httpService",["$http","$q",function(a,b){var c=this;c.getBlog=function(){return a.jsonp("https://www.googleapis.com/blogger/v3/blogs/1357003820482584675?key=AIzaSyBwh5B3d-nVf8Ut6mf690Id5miFFQ01s0M&callback=JSON_CALLBACK")};
c.getBlogPosts=function(){return a.jsonp("https://www.googleapis.com/blogger/v3/blogs/1357003820482584675/posts?maxPosts=9999&key=AIzaSyBwh5B3d-nVf8Ut6mf690Id5miFFQ01s0M&callback=JSON_CALLBACK")};c.getLabeledPost=function(b){return a.jsonp("https://www.googleapis.com/blogger/v3/blogs/1357003820482584675/posts?maxResults=20&labels="+b+"&fields=nextPageToken,items(title,published,labels,content)&key=AIzaSyBwh5B3d-nVf8Ut6mf690Id5miFFQ01s0M&callback=JSON_CALLBACK")};var d={items:[]},e,f,k=function(b,
c){var g="https://www.googleapis.com/blogger/v3/blogs/1357003820482584675/posts?maxResults=20";c&&(g+="&pageToken="+c);g+="&labels="+e+"&fields=nextPageToken,items(title,published,labels,content)&key=AIzaSyBwh5B3d-nVf8Ut6mf690Id5miFFQ01s0M&callback=JSON_CALLBACK";a.jsonp(g).success(function(a,b,c,g){d.items.push.apply(d.items,a.items);a.nextPageToken?k(e,a.nextPageToken):f.resolve(d)}).error(function(a,b,c,d){})};c.getLabeledPostRecursive=function(a,d){c.resetRecursiveGet();f=b.defer();e=a;k();return f.promise};
c.resetRecursiveGet=function(){f=b.defer();e="";d={items:[]}}}])})();